(function(){angular.module("FiveScorersApp",["ngRoute","ngMaterial"]);function e(e,r){e.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/players",{templateUrl:"/choosePlayers/choosePlayers.view.html",controller:"choosePlayersCtrl",controllerAs:"vm"}).when("/choices",{templateUrl:"/choices/choices.view.html",controller:"choicesCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});r.html5Mode(true)}angular.module("FiveScorersApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("FiveScorersApp").controller("homeCtrl",e);function e(){var e=this;e.pageHeader={title:"Welcome to the Five Scorers homepage"}}})();(function(){angular.module("FiveScorersApp").service("scorerData",e);e.$inject=["$http","authentication"];function e(e,r){var t=function(t){var o={playerName:t};return e.post("/api/playerChoice",o,{headers:{Authorization:"Bearer "+r.getToken()}})};var o=function(){return e.get("/api/choices")};return{addChoice:t,getChoices:o}}})();(function(){angular.module("FiveScorersApp").service("authentication",e);e.$inject=["$http","$window"];function e(e,r){var t=function(e){r.localStorage["fiveScorersToken"]=e};var o=function(){return r.localStorage["fiveScorersToken"]};register=function(r){return e.post("/api/register",r).then(function(e){t(e.data.token)})};login=function(r){return e.post("/api/login",r).then(function(e){t(e.data.token)})};logout=function(){r.localStorage.removeItem("fiveScorersToken")};var n=function(){var e=o();if(e){var t=JSON.parse(r.atob(e.split(".")[1]));return t.exp>Date.now()/1e3}else{return false}};var i=function(){if(n()){var e=o();var t=JSON.parse(r.atob(e.split(".")[1]));return{email:t.email,name:t.name}}};return{saveToken:t,getToken:o,register:register,login:login,logout:logout,isLoggedIn:n,currentUser:i}}})();(function(){angular.module("FiveScorersApp").controller("choosePlayersCtrl",e);e.$inject=["scorerData"];function e(e){var r=this;r.pageHeader={title:""};r.onSubmit=function(){e.addChoice(r.selectedItem.name);return true};r.allPlayers=[{name:"shearer"},{name:"cantona"}];r.querySearch=o;r.selectedItemChange=t;function t(e){r.selectedItem=JSON.stringify(e)}function o(e){return r.allPlayers.filter(n(e))}function n(e){var r=angular.lowercase(e);return function e(t){return t.name.indexOf(r)===0}}}})();(function(){angular.module("FiveScorersApp").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,r){var t=this;t.pageHeader={title:"Create a new Five Scorers account"};t.credentials={name:"",email:"",password:""};t.returnPage=e.search().page||"/";t.onSubmit=function(){t.formError="";if(!t.credentials.name||!t.credentials.email||!t.credentials.password){t.formError="All fields required, please try again";return false}else{t.doRegister()}};t.doRegister=function(){t.formError="";r.register(t.credentials).catch(function(e){t.formError=e}).then(function(){e.search("page",null);e.path(t.returnPage)})}}})();(function(){angular.module("FiveScorersApp").controller("loginCtrl",e);e.$inject=["$location","authentication"];function e(e,r){var t=this;t.pageHeader={title:"Sign in"};t.credentials={email:"",password:""};t.returnPage=e.search().page||"/";t.onSubmit=function(){t.formError="";if(!t.credentials.email||!t.credentials.password){t.formError="All fields required, please try again";return false}else{t.doLogin()}};t.doLogin=function(){t.formError="";r.login(t.credentials).catch(function(e){t.formError=e}).then(function(){e.search("page",null);e.path(t.returnPage)})}}})();(function(){angular.module("FiveScorersApp").controller("choicesCtrl",e);e.$inject=["scorerData"];function e(e){var r=this;r.pageHeader={title:"This is what you've chosen"};e.getChoices().then(function(e){r.choices=e.data})}})();